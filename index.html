<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Verification Successful</title>

<style>
body{
    margin:0;
    padding:0;
    font-family:Arial, sans-serif;
    background:#0f0f0f;
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    text-align:center;
}

.container{
    max-width:400px;
    padding:20px;
}

.loader{
    width:70px;
    height:70px;
    border:6px solid #333;
    border-top:6px solid #ff3c3c;
    border-radius:50%;
    margin:20px auto;
    animation:spin 1s linear infinite;
}

@keyframes spin{
    0%{transform:rotate(0deg);}
    100%{transform:rotate(360deg);}
}

.button{
    display:inline-block;
    margin-top:20px;
    padding:12px 25px;
    background:#ff3c3c;
    color:white;
    text-decoration:none;
    border-radius:30px;
    font-weight:bold;
}

.small{
    font-size:13px;
    opacity:0.7;
    margin-top:15px;
}
</style>
</head>
<body>

<div class="container">
    <h2>Verification Successful</h2>
    <p>Please wait while we unlock your app...</p>

    <div class="loader"></div>

    <p id="countdown">Redirecting in 4 seconds...</p>

    <a id="manualBtn" class="button" style="display:none;">
        Open App Manually
    </a>

    <div class="small">
        If the app does not open automatically, click the button above.
    </div>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const device_id = params.get("device_id");
const token = params.get("token");

let seconds = 4;
const countdownText = document.getElementById("countdown");

const manualBtn = document.getElementById("manualBtn");

if(device_id && token){

    const deepLink = 
        "myapp://unlock?device_id="
        + device_id +
        "&token=" +
        token;

    manualBtn.href = deepLink;

    const interval = setInterval(function(){
        seconds--;
        countdownText.innerText =
            "Redirecting in " + seconds + " seconds...";

        if(seconds <= 0){
            clearInterval(interval);

            window.location.href = deepLink;

            setTimeout(function(){
                manualBtn.style.display = "inline-block";
            },2000);
        }

    },1000);

}else{
    document.querySelector(".container").innerHTML =
        "<h2>Invalid Verification</h2><p>Required parameters missing.</p>";
}
</script>

</body>
</html>
